<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
<title>Träna Nu</title>
    <!-- good but not ideal -->


<style type="text/css">
/* rounded corners in safari on a div */
div {
    -webkit-border-radius: 10px;
}
/* for firefox */
div {
    -moz-border-radius: 10px;
}
/* cool shadow, but maybe not useful */
h1 {
    text-shadow: 2px 2px 6px black;
}


</style>
<!--  <link rel="stylesheet" href="iphone.css">-->
<link rel="apple-touch-icon" href="image.png" />

<script src="data.js">
</script>

<script>

var lang='sv';
var data={};
if (lang=='sv') {
data=data_sv;
}
var log = new Array();

function go(o) {
    if (o.niva.value == -1) {
	alert('missing niva')
	return false;
    }
    if (o.form.value == -1) {
	alert('missing form')
	return false;
    }
    if (o.tid.value == -1) {
	alert('missing tid')
	return false;
    }



    var val = o.niva.value + o.form.value + o.tid.value;
    window.localStorage.setItem("status", val);
    log.push(val);
    window.localStorage.setItem("log", log);
    console.log('V= ' + val);
    console.log(log);
    
    if (val in data) {
	console.log(data[val]);
	aa = data[val];
	for (ii in aa) {
	    
	    if (data[val][ii]['rubrik']) {
		var myElement = document.createElement("li");
		var newlink = document.createElement('a');
		newlink.setAttribute('href', '#');
		newlink.setAttribute('onclick', 'showtxt("'+ val +'","'+ ii +'")');
		txt = document.createTextNode(data[val][ii]['rubrik']);

		 newlink.appendChild(txt);
		console.log(aa);
		myElement.appendChild(newlink);
		
		document.getElementById("pass").appendChild(myElement);
	    }
	}
	//document.getElementById('txt').innerHTML = 
    } 
    else {
	alert('Missing data');
    }
    showlogg();

}

function init() {
    var val = window.localStorage.getItem("status");
    
    var logtxt = window.localStorage.getItem("log") || '';
    log = logtxt.split(",");
    console.log('LOG' + log);
    if (val) {
	var dd=val.split("");
	console.log(dd);
	set_selected('niva',dd[0]);
	set_selected('form',dd[1]);
	set_selected('tid',dd[2]);
	//    alert(dd);
	document.getElementById('txt').innerHTML = data[val]['pass2']['txt'];
//	document.getElementById('txt').innerHTML = data[val]['1'];
    }
    showlogg();
    navigator.geolocation.getCurrentPosition(function(position) {
	var coords = position.coords;
	document.getElementById('latlon').innerHTML = coords.latitude + ', ' + coords.longitude;

    });
}
function set_selected(name,v) {
    var sel = document.getElementsByName(name)[0];
    
    for (var i=1; i<sel.options.length; i++) {
	if (v == sel.options[i].value) {
	    sel.options[i].selected=true;
	}
    }
    console.log(sel);
}

function showlogg() {
    var  tt='<ul>';
    for (var i=1; i<log.length; i++) {
	
	console.log(log[i]);
	tt = tt + '<li>' + log[i];    
    }
    tt= tt + '</ul>';
    console.log(tt);
    document.getElementById('historik').innerHTML = tt;
}
function reset() {
    window.localStorage.clear();
}
function showtxt(val,pass) {
//    alert(val);
//    alert(pass);
    var ele = document.getElementById('main');
    ele.style.display = "none";
    document.getElementById('subtxt').innerHTML = data[val][pass]['txt'];
}
function back() {
    var ele = document.getElementById('main');
    ele.style.display = "block";
    var ele1 = document.getElementById('subtext');
    ele1.style.display = "none";
}
</script>

</head>

<body onload=init();>
    <a href="#" onclick="reset();" >Reset</a>
    <a href="#" onclick="back();" >Back</a>
<h1> Träna Nu</h1>


<div id = "main">

<form name="trananu">
<select name="niva">
  <option value="-1">Välj nivå</option>
  <option value="1">Lätt</option>
  <option value="2">Medel</option>
  <option value="3">Svår</option>
</select>
<p>
<select name="form">
  <option value="-1">Välj form</option>
  <option value="1">Löpning</option>
  <option value="2">Armar</option>
  <option value="3">Mage</option>
</select>
<p>
<select name="tid">
  <option value="-1">Välj tid</option>
  <option value="1">15-20 min</option>
  <option value="2">35-40 min</option>
  <option value="3">55-60 min</option>
</select>
<p>
<input type="button" value="Go" onclick="go(this.form); return false;">
</form>
<h2>Rubrik</h2>
<div id="txt">
</div>
<ul id="pass">
  </ul>
</div>
<div id="subtxt">
</div>
<h3>Historik</h3>
<div id="historik">

</div>
    <h4>Longitud, Latitude</h4>
<div id="latlon">
</div>
</body>
</html>
